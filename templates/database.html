{% extends "layout.html" %}
{% block body %}

<div class="modal fade" id="delete-confirm">
	<div class="modal-dialog modal-lg">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
				<h4 class="modal-title">Delete Database</h4>
			</div>
			<form class="form-horizontal" role="form" method="POST" action="{{ url_for('database_delete', database_id=db.id) }}">
				<input type="hidden" name="_csrf_token" value="{{ csrf_token() }}" />
				<div class="modal-body">
				<p>Are you sure you want to delete this database? This will delete the data on the server. This is NON RECOVERABLE!</p>
				</div><!-- /.modal-body -->
				<div class="modal-footer">
					<button type="button" class="btn btn-default" data-dismiss="modal">No! I take it all back!</button>
					<button type="submit" class="btn btn-primary">Yes, nuke it from orbit</button>
				</div><!-- /.modal-footer -->
			</form><!-- /.form -->
		</div><!-- /.modal-content -->
	</div><!-- /.modal-dialog -->
</div><!-- /.modal -->

<div class="modal fade" id="passwd-confirm">
	<div class="modal-dialog modal-lg">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
				<h4 class="modal-title">Set new password</h4>
			</div>
			<form class="form-horizontal" role="form" method="POST" action="{{ url_for('database_passwd_rng', database_id=db.id) }}">
				<input type="hidden" name="_csrf_token" value="{{ csrf_token() }}" />
				<div class="modal-body">
				<p>Are you sure you want to set a new random password for the database?</p>
				</div><!-- /.modal-body -->
				<div class="modal-footer">
					<button type="button" class="btn btn-default" data-dismiss="modal">No! I take it all back!</button>
					<button type="submit" class="btn btn-primary">Yes, engage the RNG!</button>
				</div><!-- /.modal-footer -->
			</form><!-- /.form -->
		</div><!-- /.modal-content -->
	</div><!-- /.modal-dialog -->
</div><!-- /.modal -->

<div class="page-header">
  <h1><span class="glyphicon glyphicon-book"></span> {{ db.name }}</h1>
</div>

<div class="row">
	<div class="col-md-4">
		<div class="panel panel-success panel2k">
			<div class="panel-heading">
				<h3 class="panel-title">Information</h3>
			  </div>
			  <div class="panel-body">
				<table class="statable">
					<tbody>
						<tr>
							<td><strong>Server:</strong></td>
							<td><a href="{{ url_for('server_view', server_name=db.server) }}">{{ db.server }}</a></td>
						</tr>
						<tr>
							<td><strong>Size:</strong></td>
							<td>
							{% if db_size_error %}
							{{ db_size_error }}
							{% else %}
							{{db_size|filesizeformat}}
							{% endif %}
								
							</td>
						</tr>
						<tr>
							<td><strong>Create Date:</strong></td>
							<td>{{db.create_date}}</td>
						</tr>
					</tbody>
				</table>
			</div>
		</div>
		<div class="panel panel-danger panel2k">
			<div class="panel-heading">
				<h3 class="panel-title">Actions</h3>
			  </div>
			  <div class="panel-body">
				<ul class="nav nav-pills nav-stacked">
				  <li><a href="{{ url_for('database_details',database_id=db.id) }}"><span class="glyphicon glyphicon-eye-open"></span> View connection details</a></li>						
				  <li><a href="#" data-toggle="modal" data-target="#passwd-confirm"><span class="glyphicon glyphicon-pencil"></span> Set new random password</a></li>				
				  <li><a href="#" data-toggle="modal" data-target="#delete-confirm"><span class="glyphicon glyphicon-trash"></span> Delete Database</a></li>
				</ul>			
			</div>
		</div>		
	</div>
	<div class="col-md-8">
		<div class="panel panel-info panel42k">
			<div class="panel-heading">
				<h3 class="panel-title">Edit Details</h3>
			  </div>
			  <div class="panel-body">
				<form class="form-horizontal" role="form" method="POST">
					<input type="hidden" name="_csrf_token" value="{{ csrf_token() }}" />
					<div class="form-group">
						<label for="inputOwner" class="col-lg-2 control-label">Owner</label>
							<div class="col-lg-10">
								<input type="text" class="form-control" id="inputOwner" name="database_owner" {% if db.owner %}value="{{ db.owner }}" {% endif %}/>
								<span class="help-block">The database owner</span>
							</div>
					</div>
					<div class="form-group">
						<label for="inputDescription" class="col-lg-2 control-label">Description</label>
							<div class="col-lg-10">
								<input type="text" class="form-control" id="inputDescription" name="database_desc" {% if db.description %}value="{{ db.description }}" {% endif %}>
								<span class="help-block">What the database is used for and/or ticket reference</span>
							</div>
					</div>
						<div class="form-group">
						<label for="inputPassword" class="col-lg-2 control-label">Password</label>
						<div class="col-lg-10">
							<input type="password" class="form-control" id="inputPassword" name="database_passwd"></input>
							<span class="help-block">Leave blank if you don't want to change the password</span>
						</div>
					</div>
				
					<div class="form-group">
						<div class="col-lg-offset-2 col-lg-10">
							<button type="submit" class="btn btn-default">Save Changes</button>
						</div>
					</div>
				</form>
			</div>
		</div>
	</div>
</div>

{% endblock %}
